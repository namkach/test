version: 2.1
orbs:
  cypress: cypress-io/cypress@1
workflows:
  commit-workflow:
    jobs:
      build:
        executor:
          name: win/default
          shell: powershell.exe
        steps:
          - cypress/run:
              name: "run test"
              shell: powershell.exe
              command: |
                npm config rm proxy
                npm config rm https-proxy
                npm config set proxy http://username:password@proxyname:8080 
                npm config set https-proxy http://username:password@proxyname:8080
                npx cypress run




    # jobs:
    #   build:
    #     executor: win/default
    #   steps:
    #     - cypress/run :
    #       command: npm config rm proxy && npm config rm https-proxy && npm config set proxy http://username:password@proxyname:8080 && npm config set https-proxy http://username:password@proxyname:8080 && npx cypress run
            
            
            
            # export HTTP_PROXY=http://sunitakac:sysbyp@ss4@sbrproxy01.cpall.co.th:8080  && echo '======1=======' && env && echo '=======2======' && echo $HTTP_PROXY && echo '=======3======' && npx cypress run